<!-- TODO : recupere toutes les cryptos sur la route qui viens d'être crée. Puis les mettres dans le select 
pour enfin faire des requetes sur les cryptos qu'on veux. Faire un select qui contient apres toutes les fenetres
temporelle et enfin tous les types de graph qu'on peut afficher -->

<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
</head>
<body>

    <!-- Menu Deroulant pour le type de graphique -->
    <div class="form-group">
        <select class="form-control" id="crypto">
            <option value="VUE_STAT_DMLA"> BIFF DANS LE TEMPS </option>
        </select>

        <!--  Menu Deroulant pour le type de graphique -->
        <select class="form-control" id="type-rapport">
			<option value="line">Ligne</option>
            <!--
			<option value="bar">Histogramme</option>
            <option value="doughnut">Donut</option>
            <option value="pie">Camembert</option>
			-->
        </select>
    </div>

 	<div id="graph-container">
 		<canvas id="graph" width="400" height="400"></canvas>
 	</div>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	
	<!-- <script type="text/javascript" src="app.js"></script> -->

	<script type="text/javascript">
        // Fonction de creation du Graphique via la lib Chart.js
  		$.ajax({
			url : 'http://localhost:3000/getChart/XRPUSDT/1w',
			type : 'GET',
			dataType : 'json',
			success : function(res, statut){ 
				var myData = res
				var label = []
				var value = []

				$.each(myData, (index, row) => {
					label.push(row.openTime)
					value.push(row.closeValue)
				})


				createGraph(label, value, 'line')
			}
		});



		var createGraph = function(labels,data,type){

			$("#graph-container").html("");
			$("#graph-container").html('<canvas id="graph" style="display: block; height: 169px; width: 339px;" width="678" height="338" ></canvas>');
			var ctx = document.getElementById("graph").getContext('2d');
			var myChart = new Chart(ctx, {
				    type: type,
				    data: {
				        labels: labels,
				        datasets: [{
				            label: '',
				            data: data,
				            backgroundColor: [
				                'rgba(255, 99, 132, 0.2)',
				                'rgba(54, 162, 235, 0.2)',
				                'rgba(255, 206, 86, 0.2)',
				                'rgba(75, 192, 192, 0.2)',
				                'rgba(153, 102, 255, 0.2)',
				                'rgba(255, 159, 64, 0.2)'
				            ],
				            borderColor: [
				                'rgba(255,99,132,1)',
				                'rgba(54, 162, 235, 1)',
				                'rgba(255, 206, 86, 1)',
				                'rgba(75, 192, 192, 1)',
				                'rgba(153, 102, 255, 1)',
				                'rgba(255, 159, 64, 1)'
				            ],
				            borderWidth: 1
				        }]
				    },
				    options: {
				        scales: {
				            yAxes: [{
				                ticks: {
				                    beginAtZero:true
				                }
				            }]
				        },
                        legend: {
                            display: (type == 'doughnut' || type == 'pie')
                        },
				    }
				});
		};

	</script>
</body>
</html>